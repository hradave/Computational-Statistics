---
title: "732A90: Computational Statistics"
subtitle: "Computer lab3 - Group11"
author: "Sofie Jörgensen, Oriol Garrobé Guilera, David Hrabovszki"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  pdf_document:
      fig_caption: yes
header-includes:
- \usepackage{float}
---

```{r setup, include=FALSE, eval=TRUE, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Question 1: Cluster sampling

```{r, echo=FALSE, warning=FALSE}
# R version
RNGversion('3.5.1')
#libraries
library(ggplot2)
```


### 1.

```{r}
# Question 1: Cluster sampling
# 1.1
data <- read.csv2("population.csv",sep=";")
data$Prob <- data$Population / sum(data$Population)
```

### 2. 
```{r}

```


# Question 2: Different distributions

In this question we are given the double exponential (Laplace) distribution with the location parameter $\mu$ and the scale parameter $\alpha$, where the formula is given by

$$DE(\mu,\alpha) = \frac{\alpha}{2} \text{exp}(-\alpha|x-\mu|).$$


### 1.

The aim of this task is to generate random numbers from a double exponential distribution with $\mu=0$ and $\alpha=1$, that is $DE(0, 1)$, from a uniform distribution $\text{Unif}(0, 1)$ by using the inverse CDF method. For this, we will generate 10000 random numbers, and a plot histogram of the results. 


Let, 
$$X \stackrel{}\sim DE(0,1)$$

Then,
$${f_x}(x) = \frac{1}{2} exp(-|x|) $$

Also,
$${F_x}(x) = \int_{-\infty}^{x} {f_x}(s)ds = \frac{1}{2} exp(-|s|)ds$$
Therefore,

$$
{F_x}(x) = \begin{cases} \frac{exp(x)}{2} ,x < 0 \\ 1 - \frac{exp(-x)}{2}, x \geq 0 \end{cases}
$$

!!!QUESTION: Here I only use the function for x>0. Should we do it for bigger and smaller than 0????? !!!!

Using the CDF method we look for $F^{-1}_{x}$, which is:
$$F^{-1}_{x}(y) = -ln(2-2y) $$


Hence, if $U\stackrel{}\sim U(0,1)$, then
$$-ln(2-2U) = X \stackrel{}\sim DE(0,1)$$

Using this formula bla bla...
```{r}
uniform <- runif(1000, min = 0, max = 1) #Not allowed, use from ex.1
DE_numbers <- -log(2 - 2 * uniform)
hist(DE_numbers, breaks = 30)
```

The histogram looks like an exponential??? 

### 2.

